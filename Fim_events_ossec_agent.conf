<!-- ============================================ -->
  <!-- ============================================ -->
  <!-- LINUX AGENTS - Hosts File & Critical Files  -->
  <!-- ============================================ -->
  <agent_config os="Linux">
    <syscheck>
      <frequency>300</frequency>
      <!-- Hosts file and DNS configuration -->
      <directories check_all="yes" whodata="yes" report_changes="yes">/etc/hosts</directories>
      <directories check_all="yes" whodata="yes" report_changes="yes">/etc/resolv.conf</directories>
      <directories check_all="yes" whodata="yes" report_changes="yes">/etc/nsswitch.conf</directories>
      <directories check_all="yes" whodata="yes" report_changes="yes">/etc/hostname</directories>
      <!-- Authentication files -->
      <directories check_all="yes" whodata="yes" report_changes="yes">/etc/passwd</directories>
      <directories check_all="yes" whodata="yes" report_changes="yes">/etc/shadow</directories>
      <directories check_all="yes" whodata="yes" report_changes="yes">/etc/group</directories>
      <directories check_all="yes" whodata="yes" report_changes="yes">/etc/sudoers</directories>
      <!-- SSH configuration -->
      <directories check_all="yes" whodata="yes" report_changes="yes">/etc/ssh/sshd_config</directories>
      <!-- Cron jobs - Persistence -->
      <directories check_all="yes" whodata="yes" report_changes="yes">/etc/crontab</directories>
      <directories check_all="yes" whodata="yes" report_changes="yes">/etc/cron.d</directories>
      <!-- Systemd services - Persistence -->
      <directories check_all="yes" whodata="yes" report_changes="yes">/etc/systemd/system</directories>
      <!-- Who-data configuration -->
      <whodata>
        <provider>audit</provider>
        <queue_size>50000</queue_size>
      </whodata>
      <!-- Skip virtual filesystems -->
      <skip_nfs>yes</skip_nfs>
      <skip_dev>yes</skip_dev>
      <skip_proc>yes</skip_proc>
      <skip_sys>yes</skip_sys>
    </syscheck>
  </agent_config>
  <!-- ============================================ -->
  <!-- macOS (DARWIN) AGENTS - Hosts File & Critical Files -->
  <!-- ============================================ -->
  <!-- IMPORTANT: macOS does NOT support realtime or whodata modes! -->
  <!-- Only scheduled scans are supported. Use lower frequency for faster detection -->
  <agent_config os="Darwin">
    <syscheck>
      <!-- Lower frequency for faster detection (5 minutes) -->
      <frequency>300</frequency>
      <!-- Hosts file and DNS configuration -->
      <!-- NOTE: Do NOT use realtime="yes" or whodata="yes" - not supported on macOS -->
      <directories check_all="yes" report_changes="yes">/etc/hosts</directories>
      <directories check_all="yes" report_changes="yes">/etc/resolv.conf</directories>
      <directories check_all="yes" report_changes="yes">/private/etc/hosts</directories>
      <!-- Authentication and user files -->
      <directories check_all="yes" report_changes="yes">/etc/passwd</directories>
      <directories check_all="yes" report_changes="yes">/etc/group</directories>
      <directories check_all="yes" report_changes="yes">/etc/sudoers</directories>
      <directories check_all="yes" report_changes="yes">/etc/sudoers.d</directories>
      <!-- SSH configuration -->
      <directories check_all="yes" report_changes="yes">/etc/ssh/sshd_config</directories>
      <directories check_all="yes" report_changes="yes">/Users/*/.ssh/authorized_keys</directories>
      <!-- LaunchDaemons and LaunchAgents - Persistence mechanisms -->
      <directories check_all="yes" report_changes="yes">/Library/LaunchDaemons</directories>
      <directories check_all="yes" report_changes="yes">/Library/LaunchAgents</directories>
      <directories check_all="yes" report_changes="yes">/System/Library/LaunchDaemons</directories>
      <directories check_all="yes" report_changes="yes">/System/Library/LaunchAgents</directories>
      <directories check_all="yes" report_changes="yes">/Users/*/Library/LaunchAgents</directories>
      <!-- Cron jobs -->
      <directories check_all="yes" report_changes="yes">/etc/crontab</directories>
      <directories check_all="yes" report_changes="yes">/usr/lib/cron/tabs</directories>
      <directories check_all="yes" report_changes="yes">/var/at/tabs</directories>
      <!-- Shell profiles - Persistence -->
      <directories check_all="yes" report_changes="yes">/etc/profile</directories>
      <directories check_all="yes" report_changes="yes">/etc/bashrc</directories>
      <directories check_all="yes" report_changes="yes">/etc/zshrc</directories>
      <directories check_all="yes" report_changes="yes">/Users/*/.bash_profile</directories>
      <directories check_all="yes" report_changes="yes">/Users/*/.bashrc</directories>
      <directories check_all="yes" report_changes="yes">/Users/*/.zshrc</directories>
      <!-- System binaries -->
      <directories check_all="yes">/usr/bin</directories>
      <directories check_all="yes">/usr/sbin</directories>
      <directories check_all="yes">/bin</directories>
      <directories check_all="yes">/sbin</directories>
    </syscheck>
  </agent_config>
  <!-- ============================================ -->
  <!-- WINDOWS AGENTS - Hosts File & Critical Files -->
  <!-- ============================================ -->
  <agent_config os="Windows">
    <syscheck>
      <frequency>300</frequency>
      <!-- Windows Hosts file -->
      <directories check_all="yes" whodata="yes" report_changes="yes">C:\Windows\System32\drivers\etc\hosts</directories>
      <directories check_all="yes" whodata="yes" report_changes="yes">C:\Windows\System32\drivers\etc</directories>
      <!-- Task Scheduler - Persistence -->
      <directories check_all="yes" whodata="yes" report_changes="yes">C:\Windows\System32\Tasks</directories>
      <!-- Startup folders - Persistence -->
      <directories check_all="yes" whodata="yes" report_changes="yes">C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup</directories>
      <!-- Windows Registry - Startup keys -->
      <windows_registry check_all="yes" report_changes="yes">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</windows_registry>
      <windows_registry check_all="yes" report_changes="yes">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce</windows_registry>
      <windows_registry check_all="yes" report_changes="yes">HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</windows_registry>
      <!-- DNS/Network Registry -->
      <windows_registry check_all="yes" report_changes="yes">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters</windows_registry>
      <windows_registry check_all="yes" report_changes="yes">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Dnscache</windows_registry>
      <!-- Audit interval for who-data -->
      <windows_audit_interval>300</windows_audit_interval>
    </syscheck>
  </agent_config>
